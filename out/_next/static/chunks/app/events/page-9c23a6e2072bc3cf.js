(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38],{275:function(e,t,n){Promise.resolve().then(n.bind(n,8583))},8583:function(e,t,n){"use strict";n.d(t,{EventsPageContent:function(){return x}});var a=n(7437),r=n(2265),l=n(7648),i=n(8116);function s(e,t){return"all"===e||"All"===t||"all"===t||"premium"===e&&("basic"===t||"premium"===t)||"basic"===e&&"basic"===t}function o(e,t){let[n,a,r]=t.split("-").map(Number);if(6===new Date(n,a-1,r).getDay())return"Youth options";let l=(null!=e?e:"").toLowerCase();return l.includes("pitching")||l.includes("pitch")||l.includes("velo")||l.includes("rehab")?"Pitching":l.includes("hitting")||l.includes("cage")?"Hitting":l.includes("catching")||l.includes("catcher")?"Catching":l.includes("strength")||l.includes("conditioning")||l.includes("s&c")?"Lifting":l.includes("youth")?"Youth options":e||"Training"}function c(e){if(!e||!e.trim())return"—";let[t,n]=e.trim().split(":"),a=parseInt(null!=t?t:"0",10);return"".concat(0===a?12:a>12?a-12:a,":").concat(null!=n?n:"00"," ").concat(a<12?"AM":"PM")}n(257);let d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function u(e){let{events:t,onSelectEvent:n,onSelectDay:l,bookedEventIds:i=[]}=e,s=(0,r.useMemo)(()=>new Date,[]),[u,m]=(0,r.useState)(s.getFullYear()),[p,h]=(0,r.useState)(s.getMonth()),g=(0,r.useMemo)(()=>(function(e,t){let n=new Date(e,t,1),a=new Date(e,t+1,0),r=n.getDay(),l=a.getDate(),i=[];for(let e=0;e<r;e++)i.push({date:null,dateKey:""});for(let n=1;n<=l;n++){let a=new Date(e,t,n);i.push({date:a,dateKey:"".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-").concat(String(n).padStart(2,"0"))})}let s=7*Math.ceil((r+l)/7)-i.length;for(let e=0;e<s;e++)i.push({date:null,dateKey:""});return i})(u,p),[u,p]),y=(0,r.useMemo)(()=>{let e={};return t.forEach(t=>{e[t.date]||(e[t.date]=[]),e[t.date].push(t)}),Object.keys(e).forEach(t=>e[t].sort((e,t)=>(e.startTime||"").localeCompare(t.startTime||""))),e},[t]);return(0,a.jsxs)("div",{className:"event-calendar",children:[(0,a.jsxs)("div",{className:"event-calendar-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:[(0,a.jsx)("h2",{style:{margin:0,fontSize:"1.25rem"},children:new Date(u,p,1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{0===p?(h(11),m(e=>e-1)):h(e=>e-1)},"aria-label":"Previous month",children:"‹"}),(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{11===p?(h(0),m(e=>e+1)):h(e=>e+1)},"aria-label":"Next month",children:"›"})]})]}),(0,a.jsxs)("div",{className:"event-calendar-grid",style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"1px",background:"var(--border)",border:"1px solid var(--border)",borderRadius:"var(--radius)",overflow:"hidden"},children:[d.map(e=>(0,a.jsx)("div",{style:{padding:"0.5rem",background:"var(--surface-elevated)",fontSize:"0.75rem",fontWeight:600},children:e},e)),g.map((e,t)=>{let r=e.dateKey&&y[e.dateKey]||[],d=e.date&&e.date.getDate()===s.getDate()&&e.date.getMonth()===s.getMonth()&&e.date.getFullYear()===s.getFullYear();return(0,a.jsx)("div",{className:"event-calendar-cell",style:{minHeight:"90px",padding:"0.35rem",background:"var(--surface)",fontSize:"0.8rem",overflow:"auto"},children:e.date&&(0,a.jsxs)(a.Fragment,{children:[l?(0,a.jsx)("button",{type:"button",className:"event-calendar-day-num",onClick:()=>l(e.dateKey),style:{display:"inline-block",background:"none",border:"none",padding:"0.15rem 0.25rem",margin:"-0.15rem -0.25rem",fontWeight:d?700:400,color:d?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderRadius:"var(--radius)",fontSize:"inherit"},title:"View training slots on this day","aria-label":"View training slots on ".concat(e.dateKey),children:e.date.getDate()}):(0,a.jsx)("span",{style:{fontWeight:d?700:400,color:d?"var(--accent)":"var(--text-muted)"},children:e.date.getDate()}),r.map(e=>{let t=i.includes(e.id),r=e.bookedCount<e.capacity;return(0,a.jsxs)("button",{type:"button",className:"event-calendar-event-pill".concat(t?" event-calendar-event-pill--booked":""),onClick:t=>{t.stopPropagation(),n(e)},style:{display:"block",width:"100%",marginTop:"0.25rem",padding:"0.25rem 0.35rem",textAlign:"left",background:t?"var(--accent-muted)":"var(--surface-elevated)",border:r?"2px solid var(--slot-outline-open, #5a9f6a)":"2px solid var(--slot-outline-full, #b86b6b)",borderRadius:"4px",color:"var(--text)",cursor:"pointer",fontSize:"0.7rem"},title:t?"You're signed up":r?"Open slot":"Slot full",children:[(0,a.jsx)("span",{style:{fontWeight:600,display:"block"},children:o(e.program,e.date)}),(0,a.jsxs)("span",{style:{color:"var(--text-muted)",display:"block",fontSize:"0.85em"},children:[c(e.startTime)," \xb7 ",e.bookedCount,"/",e.capacity," full",t?" \xb7 You":""]})]},e.id)})]})},t)})]})]})}function m(e){let{event:t,userTier:n,allPrograms:i,onClose:d,onBook:u}=e,m=!!t&&s(n,t.subscriptionTier),p=t?t.capacity-t.bookedCount:0,h=!!t&&t.bookedCount>=t.capacity,g=t&&t.program?i.filter(e=>e!==t.program&&"All"!==e):[];if((0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&d()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]),!t)return null;let y=[t.startTime,t.endTime].filter(Boolean).length?"".concat(c(t.startTime)," – ").concat(c(t.endTime)):"Time TBD";return(0,a.jsx)("div",{className:"event-booking-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"event-booking-title",onClick:d,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100,padding:"1rem"},children:(0,a.jsxs)("div",{className:"event-booking-modal",onClick:e=>e.stopPropagation(),style:{background:"var(--surface)",border:"1px solid var(--border)",borderRadius:"var(--radius)",maxWidth:"420px",width:"100%",maxHeight:"90vh",overflow:"auto",padding:"1.5rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.02em"},children:o(t.program,t.date)}),(0,a.jsx)("h2",{id:"event-booking-title",style:{margin:"0.15rem 0 0",fontSize:"1.25rem"},children:t.title})]}),(0,a.jsx)("button",{type:"button",onClick:d,"aria-label":"Close",style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:"1.5rem",cursor:"pointer",lineHeight:1},children:"\xd7"})]}),(0,a.jsxs)("p",{style:{color:"var(--text-muted)",margin:"0 0 1rem",fontSize:"0.95rem"},children:[new Date(t.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),y&&" \xb7 ".concat(y)]}),(0,a.jsx)("p",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:t.location}),(0,a.jsxs)("p",{style:{margin:"0 0 1rem",fontSize:"0.9rem",color:"var(--text-muted)"},children:[t.program&&"".concat(t.program," \xb7 "),t.type]}),(0,a.jsxs)("div",{className:"event-occupancy",style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--surface-elevated)",borderRadius:"var(--radius)"},children:[(0,a.jsx)("strong",{style:{fontSize:"0.9rem"},children:"Spots"}),(0,a.jsxs)("p",{style:{margin:"0.25rem 0 0",fontSize:"1rem"},children:[(0,a.jsxs)("span",{style:{color:h?"var(--accent)":"var(--text)"},children:[t.bookedCount," of ",t.capacity," filled"]}),!h&&(0,a.jsxs)("span",{style:{color:"var(--text-muted)",marginLeft:"0.5rem"},children:["(",p," left)"]})]})]}),m&&!h&&(0,a.jsx)("button",{type:"button",className:"btn btn-primary",style:{width:"100%",marginBottom:"1rem"},onClick:()=>u(t.id),children:"Book this slot"}),!m&&(0,a.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"rgba(234, 88, 12, 0.1)",border:"1px solid var(--accent)",borderRadius:"var(--radius)"},children:[(0,a.jsxs)("p",{style:{margin:0,fontSize:"0.9rem"},children:["This slot requires ",(0,a.jsx)("strong",{children:t.subscriptionTier})," access. Your plan: ",(0,a.jsx)("strong",{children:"all"===n?"All programs":"premium"===n?"Premium":"Basic"}),"."]}),(0,a.jsx)(l.default,{href:"/contact",className:"btn btn-primary",style:{marginTop:"0.75rem",display:"inline-block"},children:"Upgrade to book"})]}),h&&m&&(0,a.jsxs)("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.9rem"},children:["This slot is full. ",(0,a.jsx)(l.default,{href:"/contact",children:"Contact us"})," to join the waitlist."]}),g.length>0&&(0,a.jsxs)("div",{className:"event-other-programs",style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid var(--border)"},children:[(0,a.jsx)("p",{style:{margin:"0 0 0.5rem",fontSize:"0.85rem",color:"var(--text-muted)"},children:"Explore other programs"}),(0,a.jsx)("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:g.slice(0,4).map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(l.default,{href:"/member-registration",children:e})},e))})]})]})})}function p(e){var t;let n=(null!==(t=e.program)&&void 0!==t?t:"").toLowerCase();return n.includes("hitting")||n.includes("cage")}function h(e){var t;let n=(null!==(t=e.program)&&void 0!==t?t:"").toLowerCase();return n.includes("pitching")||n.includes("pitch")||n.includes("velo")||n.includes("rehab")}function g(e){var t;let n=(null!==(t=e.program)&&void 0!==t?t:"").toLowerCase();return n.includes("catching")||n.includes("catcher")}function y(e){var t;let n=(null!==(t=e.program)&&void 0!==t?t:"").toLowerCase();return n.includes("strength")||n.includes("conditioning")||n.includes("s&c")}function b(e){var t;let{events:n}=e,{tier:d}=(0,i.m)(),[b,f]=(0,r.useState)(""),[v,x]=(0,r.useState)(null),[j,k]=(0,r.useState)(!1),[w,C]=(0,r.useState)([]),[S,N]=(0,r.useState)(null),[T,E]=(0,r.useState)(!0);(0,r.useEffect)(()=>{fetch("/api/member/bookings").then(e=>e.ok?e.json():[]).then(e=>{C(Array.isArray(e)?e.map(e=>e.eventId):[])}).catch(()=>C([])).finally(()=>E(!1))},[]);let D=(0,r.useMemo)(()=>j?n.filter(e=>w.includes(e.id)):n,[n,j,w]),z=(0,r.useMemo)(()=>b?"available"===b?D.filter(e=>s(d,e.subscriptionTier)):"hitting"===b?D.filter(p):"pitching"===b?D.filter(h):"catching"===b?D.filter(g):"strength"===b?D.filter(y):D:D,[D,b,d]),B=(0,r.useMemo)(()=>z.map(e=>{var t;return{id:e.id,title:e.title,date:e.date,startTime:e.startTime,endTime:e.endTime,type:e.type,program:e.program,location:null!==(t=e.location)&&void 0!==t?t:"",capacity:e.capacity,bookedCount:e.bookedCount,subscriptionTier:e.subscriptionTier}}),[z]),P=(0,r.useMemo)(()=>S?z.filter(e=>e.date===S).sort((e,t)=>(e.startTime||"").localeCompare(t.startTime||"")):[],[z,S]),_=(0,r.useMemo)(()=>{if(!S)return"";let[e,t,n]=S.split("-").map(Number);return new Date(e,t-1,n).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"})},[S]),I=(0,r.useMemo)(()=>Array.from(new Set(n.map(e=>e.program).filter(Boolean))),[n]),[L,M]=(0,r.useState)(null),F=(0,r.useCallback)(async e=>{M(null);try{let t=await fetch("/api/member/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e})});if(401===t.status){window.location.href="/contact?book=".concat(e);return}let n=await t.json().catch(()=>({}));if(!t.ok){M({type:"error",msg:n.error||"Booking failed"});return}M({type:"success",msg:"Booked! View your training slots in Profile → Calendar."}),x(null),fetch("/api/member/bookings").then(e=>e.ok?e.json():[]).then(e=>{let t=Array.isArray(e)?e.map(e=>e.eventId):[];C(t)}).catch(()=>{})}catch(e){M({type:"error",msg:"Booking failed"})}},[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{style:{marginBottom:"1.5rem",display:"flex",flexWrap:"wrap",gap:"1rem",alignItems:"center"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Show:"}),(0,a.jsxs)("label",{className:"scheduling-toggle-label",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,a.jsx)("input",{type:"radio",name:"scheduling-view",checked:j,onChange:()=>k(!0),disabled:T}),(0,a.jsx)("span",{children:"My slots only"})]}),(0,a.jsxs)("label",{className:"scheduling-toggle-label",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,a.jsx)("input",{type:"radio",name:"scheduling-view",checked:!j,onChange:()=>k(!1)}),(0,a.jsx)("span",{children:"All slots"})]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Filter by type:"}),(0,a.jsxs)("select",{value:b,onChange:e=>f(e.target.value),style:{padding:"0.5rem 0.75rem",background:"var(--surface)",border:"1px solid var(--border)",borderRadius:"var(--radius)",color:"var(--text)",minWidth:"160px"},"aria-label":"Filter training slots by type",children:[(0,a.jsx)("option",{value:"",children:"All slots"}),(0,a.jsx)("option",{value:"available",children:"Available to me"}),(0,a.jsx)("option",{value:"hitting",children:"Hitting only"}),(0,a.jsx)("option",{value:"pitching",children:"Pitching only"}),(0,a.jsx)("option",{value:"catching",children:"Catching only"}),(0,a.jsx)("option",{value:"strength",children:"Lifting only"})]})]}),(0,a.jsx)("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Green outline = open slot \xb7 Red outline = full (each slot is ~1 hr)"})]}),L&&(0,a.jsxs)("div",{role:"alert",style:{marginBottom:"1rem",padding:"0.75rem 1rem",borderRadius:"var(--radius)",background:"success"===L.type?"var(--success-bg, #d4edda)":"var(--error-bg, #f8d7da)",color:"success"===L.type?"var(--success-text, #155724)":"var(--error-text, #721c24)"},children:[L.msg,"success"===L.type&&(0,a.jsx)(l.default,{href:"/profile/calendar",style:{marginLeft:"0.5rem",fontWeight:600},children:"Go to Calendar"})]}),(0,a.jsxs)("section",{className:"event-calendar-section",style:{marginBottom:"2rem"},children:[j&&!T&&0===w.length&&(0,a.jsx)("p",{className:"text-muted",style:{marginBottom:"1rem",fontSize:"0.95rem"},children:"You’re not signed up for any training slots yet. Click a day on the calendar to see slots and book."}),(0,a.jsx)(u,{events:B,onSelectEvent:e=>x(n.find(t=>t.id===e.id)||null),onSelectDay:e=>N(e),bookedEventIds:w}),S?(0,a.jsxs)("div",{className:"scheduling-day-panel card card-elevated",style:{marginTop:"1.5rem",padding:"1.25rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem",marginBottom:"1rem"},children:[(0,a.jsxs)("h3",{style:{margin:0,fontSize:"1.1rem"},children:["Training slots on ",_]}),(0,a.jsx)("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>N(null),children:"Close"})]}),0===P.length?(0,a.jsx)("p",{className:"text-muted",style:{margin:0},children:"No training slots on this day with the current filter. Try another day or change the filter."}):(0,a.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:P.map(e=>{let t=s(d,e.subscriptionTier),n=e.bookedCount>=e.capacity,r=w.includes(e.id);return(0,a.jsxs)("li",{style:{padding:"0.75rem 0",borderBottom:"1px solid var(--border)",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:"0.75rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{style:{display:"block"},children:o(e.program,e.date)}),(0,a.jsxs)("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:[c(e.startTime)," \xb7 ",e.bookedCount,"/",e.capacity," full"]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>x(e),children:"View details"}),r&&(0,a.jsx)("span",{style:{fontSize:"0.85rem",color:"var(--success)"},children:"You’re signed up"}),!r&&t&&!n&&(0,a.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>F(e.id),children:"Book"}),!r&&!t&&(0,a.jsx)(l.default,{href:"/contact",className:"btn btn-primary",children:"Upgrade to book"}),!r&&t&&n&&(0,a.jsx)(l.default,{href:"/contact",className:"btn btn-secondary",children:"Waitlist"})]})]},e.id)})})]}):(0,a.jsx)("p",{className:"text-muted",style:{marginTop:"1.5rem",marginBottom:0},children:"Select a day on the calendar to see training slots on that day and view details or book."})]}),(0,a.jsx)(m,{event:v?{...v,location:null!==(t=v.location)&&void 0!==t?t:""}:null,userTier:d,allPrograms:I,onClose:()=>x(null),onBook:F})]})}function f(){return(0,a.jsxs)("section",{className:"cta-inline card card-elevated",style:{marginTop:"2rem",padding:"1.75rem"},children:[(0,a.jsx)("h2",{style:{fontSize:"1.2rem",marginTop:0,marginBottom:"0.5rem"},children:"Ready to train?"}),(0,a.jsx)("p",{style:{color:"var(--text-muted)",marginBottom:"1.25rem",fontSize:"0.95rem",lineHeight:1.5},children:"View memberships or contact us and we'll help you find the right fit."}),(0,a.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem"},children:[(0,a.jsx)(l.default,{href:"/member-registration",className:"btn btn-primary","data-testid":"page-primary-cta",children:"View memberships"}),(0,a.jsx)(l.default,{href:"/contact",className:"btn btn-secondary",children:"Contact us"})]})]})}var v=n(5850);function x(e){let{events:t}=e,n=(0,r.useMemo)(()=>{let e=new Date().toISOString().slice(0,10);return[...t].filter(t=>t.date>=e).sort((e,t)=>{var n,a;return e.date.localeCompare(t.date)||(null!==(n=e.startTime)&&void 0!==n?n:"").localeCompare(null!==(a=t.startTime)&&void 0!==a?a:"")}).slice(0,5)},[t]);return(0,a.jsx)("div",{className:"page page-events-conversion",children:(0,a.jsxs)("div",{className:"container events-page-inner events-layout-two-col",style:{paddingTop:"2rem",paddingBottom:"3rem"},children:[(0,a.jsx)("h1",{className:"events-page-title-full",children:(0,a.jsx)(v.EditableContent,{contentKey:"events_heading",fallback:"Scheduling",as:"span"})}),(0,a.jsx)("p",{className:"text-muted events-page-intro-full",style:{marginBottom:"1.5rem"},children:(0,a.jsx)(v.EditableContent,{contentKey:"events_intro",fallback:"Training slots — camps, clinics, sessions. Use the calendar to view and book by day. Toggle to show only slots you're signed up for or all slots. Green outline = open; red = full.",as:"span"})}),(0,a.jsx)("aside",{className:"events-col-upcoming","aria-label":"Upcoming",children:n.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"events-upcoming-title",children:(0,a.jsx)(v.EditableContent,{contentKey:"events_upcoming_heading",fallback:"Upcoming",as:"span"})}),(0,a.jsx)("ul",{className:"events-upcoming-list",role:"list",children:n.map(e=>(0,a.jsxs)("li",{className:"events-upcoming-item",children:[(0,a.jsx)("span",{className:"events-upcoming-date",children:function(e,t){try{let n=new Date(e).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"});return t?"".concat(n," \xb7 ").concat(t):n}catch(t){return e}}(e.date,e.startTime)}),(0,a.jsx)("span",{className:"events-upcoming-title-text",children:e.title})]},e.id))})]}):(0,a.jsx)("p",{className:"text-muted",style:{fontSize:"0.9rem"},children:"No upcoming slots listed."})}),(0,a.jsxs)("div",{className:"events-col-calendar",children:[(0,a.jsx)(b,{events:t}),(0,a.jsx)(f,{})]})]})})}},5850:function(e,t,n){"use strict";n.r(t),n.d(t,{EditableContent:function(){return i}});var a=n(7437),r=n(2265),l=n(7444);function i(e){var t;let{contentKey:n,fallback:i="",displayValue:s,as:o="span",className:c,style:d}=e,{content:u,setContentKey:m,editMode:p,isAdmin:h}=(0,l.e)(),[g,y]=(0,r.useState)(!1),[b,f]=(0,r.useState)(""),v=null!==(t=u[n])&&void 0!==t?t:i,x=void 0!==s?s:v,j=p&&h,k=e=>{j&&(e&&(e.preventDefault(),e.stopPropagation()),f(v),y(!0))},w=async()=>{try{await m(n,b),setTimeout(()=>y(!1),0)}catch(e){}};return(0,a.jsxs)(a.Fragment,{children:[j?(0,a.jsx)(o,{role:"button",tabIndex:0,className:c?"".concat(c," editable-content editable-content--on"):"editable-content editable-content--on",style:d,onClick:e=>k(e),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),k())},title:"Click to edit",children:x}):(0,a.jsx)(o,{className:c,style:d,children:x}),g&&(0,a.jsx)("div",{className:"editable-content-modal-backdrop",role:"dialog","aria-modal":"true","aria-label":"Edit content",onClick:e=>{e.preventDefault(),e.stopPropagation(),e.target===e.currentTarget&&setTimeout(()=>y(!1),0)},children:(0,a.jsxs)("div",{className:"editable-content-modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("label",{htmlFor:"editable-content-input",className:"editable-content-modal-label",children:["Edit: ",n]}),(0,a.jsx)("textarea",{id:"editable-content-input",className:"form-input editable-content-modal-input",value:b,onChange:e=>f(e.target.value),rows:4,autoFocus:!0}),(0,a.jsxs)("div",{className:"editable-content-modal-actions",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),w()},children:"Save"}),(0,a.jsx)("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),setTimeout(()=>y(!1),0)},children:"Cancel"})]})]})})]})}},7444:function(e,t,n){"use strict";n.d(t,{_:function(){return p},e:function(){return d}});var a=n(7437),r=n(2265),l=n(605);let i=["oswald","playfair"],s=["barlow","inter"];function o(e){let{themeDisplayFont:t,themeBodyFont:n}=e;return(0,r.useEffect)(()=>{var e,a;let r=(e=t||"",i.includes(e))?t:"oswald",l=(a=n||"",s.includes(a))?n:"barlow",o=document.documentElement;o.style.setProperty("--font-display-var","var(--font-display-".concat(r,")")),o.style.setProperty("--font-sans-var","var(--font-sans-".concat(l,")"))},[t,n]),null}let c=(0,r.createContext)(null);function d(){let e=(0,r.useContext)(c);if(!e)throw Error("useSiteContent must be used within SiteContentProvider");return e}let u=[{value:"oswald",label:"Oswald (sports / headlines)"},{value:"playfair",label:"Playfair Display (classic serif)"}],m=[{value:"barlow",label:"Barlow (clean geometric)"},{value:"inter",label:"Inter (neutral sans)"}];function p(e){var t,n,i;let{children:s}=e,{data:d,status:p}=(0,l.useSession)(),[h,g]=(0,r.useState)({}),[y,b]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),x=(null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.role)==="admin",j=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/site-content"),t=await e.json().catch(()=>({}));e.ok&&"object"==typeof t&&null!==t&&g(t)}catch(e){}},[]);(0,r.useEffect)(()=>{j()},[j]),(0,r.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&"e"===e.key&&(e.preventDefault(),x&&b(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[x]);let k=(0,r.useCallback)(async(e,t)=>{try{let n=await fetch("/api/admin/site-content",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e,value:t})}),a=await n.json().catch(()=>({}));if(!n.ok)throw Error(a.error||"Failed to update");"object"==typeof a&&null!==a&&g(a)}catch(e){throw e}},[]);return(0,a.jsxs)(c.Provider,{value:{content:h,setContentKey:k,editMode:y,setEditMode:b,isAdmin:x,refresh:j},children:[(0,a.jsx)(o,{themeDisplayFont:h.theme_display_font,themeBodyFont:h.theme_body_font}),s,"authenticated"===p&&x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"edit-site-fab-group",children:[y&&(0,a.jsx)("button",{type:"button",className:"edit-site-fab edit-site-fab--theme",onClick:()=>v(!0),title:"Edit theme & fonts","aria-label":"Edit theme and fonts",children:"Theme"}),(0,a.jsx)("button",{type:"button",className:"edit-site-fab",onClick:()=>b(e=>!e),title:y?"Exit edit mode (Ctrl+E)":"Edit site (Ctrl+E)","aria-label":y?"Exit edit mode":"Edit site",children:y?"Done":"Edit site"})]}),f&&(0,a.jsx)("div",{className:"editable-content-modal-backdrop",role:"dialog","aria-modal":"true","aria-label":"Theme & fonts",onClick:e=>e.target===e.currentTarget&&v(!1),children:(0,a.jsxs)("div",{className:"editable-content-modal theme-editor-modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1.25rem"},children:"Theme & fonts"}),(0,a.jsx)("p",{className:"text-muted",style:{fontSize:"0.9rem",marginBottom:"1.25rem"},children:"Change display (headings) and body fonts. Changes apply across the site."}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,a.jsxs)("label",{className:"editable-content-modal-label",children:["Display font (headings)",(0,a.jsx)("select",{className:"form-input",style:{marginTop:"0.35rem",width:"100%"},value:null!==(n=h.theme_display_font)&&void 0!==n?n:"oswald",onChange:e=>k("theme_display_font",e.target.value),children:u.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("label",{className:"editable-content-modal-label",children:["Body font",(0,a.jsx)("select",{className:"form-input",style:{marginTop:"0.35rem",width:"100%"},value:null!==(i=h.theme_body_font)&&void 0!==i?i:"barlow",onChange:e=>k("theme_body_font",e.target.value),children:m.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsx)("div",{className:"editable-content-modal-actions",style:{marginTop:"1.5rem"},children:(0,a.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>v(!1),children:"Close"})})]})})]})]})}},8116:function(e,t,n){"use strict";n.d(t,{m:function(){return o},q:function(){return s}});var a=n(7437),r=n(2265);let l="mine-perf-subscription-tier",i=(0,r.createContext)(null);function s(e){let{children:t}=e,[n,s]=(0,r.useState)("basic");(0,r.useEffect)(()=>{s(function(){try{let e=localStorage.getItem(l);if("basic"===e||"premium"===e||"all"===e)return e}catch(e){}return"basic"}())},[]);let o=(0,r.useCallback)(e=>{s(e);try{localStorage.setItem(l,e)}catch(e){}},[]);return(0,a.jsx)(i.Provider,{value:{tier:n,setTier:o},children:t})}function o(){let e=(0,r.useContext)(i);if(!e)throw Error("useSubscription must be used within SubscriptionProvider");return e}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return r.a}});var a=n(2972),r=n.n(a)}},function(e){e.O(0,[972,605,971,117,744],function(){return e(e.s=275)}),_N_E=e.O()}]);